<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,viewport-fit=cover"
    />
    <title>üéÇ Ch√∫c m·ª´ng sinh nh·∫≠t üéâ</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html,
      body {
        height: 100%;
        background: #000;
        color: #fff;
        font-family: Arial, Helvetica, sans-serif;
        overflow: hidden;
      }

      .screen {
        display: none;
        width: 100%;
        height: 100svh;
        opacity: 1;
        transition: opacity 0.9s ease;
      }

      .active {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
      }

      .fade-out {
        opacity: 0 !important;
      }

      /* ===== N√∫t nh·∫°c ===== */
      #musicToggle {
        position: fixed;
        top: 10px;
        right: 10px;
        z-index: 9999;
        padding: 8px 14px;
        border-radius: 20px;
        font-size: 14px;
        cursor: pointer;
        user-select: none;
        transition: all 0.3s ease;
        background: #eee;
        color: #000;
        font-weight: bold;
      }

      #musicToggle.active {
        background: hotpink;
        color: #fff;
        box-shadow: 0 0 10px hotpink;
      }

      /* ===== M√†n 1 ===== */
      #screen1 {
        position: relative;
        text-align: center;
        flex-direction: column;
      }

      .stars {
        position: absolute;
        inset: 0;
        background: url("https://www.transparenttextures.com/patterns/stardust.png");
        animation: twinkle 3s infinite alternate;
        z-index: 0;
      }

      @keyframes twinkle {
        from {
          opacity: 0.5;
        }

        to {
          opacity: 1;
        }
      }

      .s1-container {
        z-index: 2;
        text-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
      }

      .s1-container input {
        padding: 10px 20px;
        border-radius: 20px;
        border: none;
        outline: none;
        text-align: center;
        font-size: 16px;
        background: #222;
        color: #fff;
        box-shadow: 0 0 10px #ff69b4;
      }

      .s1-container button {
        padding: 10px 20px;
        border: none;
        border-radius: 20px;
        background: hotpink;
        color: #fff;
        font-size: 16px;
        cursor: pointer;
        box-shadow: 0 0 15px hotpink;
      }

      #fallingWrap {
        position: absolute;
        inset: 0;
        overflow: hidden;
        pointer-events: none;
        z-index: 1;
      }

      .falling {
        position: absolute;
        top: -50px;
        font-size: 40px;
        animation: fall linear infinite;
      }

      @keyframes fall {
        to {
          transform: translateY(110svh);
        }
      }

      .medal {
        z-index: 2;
      }

      /* ===== M√†n 2 ===== */
      #screen2 {
        position: relative;
      }

      #matrix {
        position: absolute;
        inset: 0;
        z-index: 0;
      }

      #countdown {
        position: relative;
        z-index: 10;
        font-size: clamp(40px, 12vw, 80px);
        font-weight: 700;
        color: pink;
        text-shadow: 0 0 20px #fff, 0 0 40px hotpink;
        margin-bottom: 12px;
      }

      #message {
        position: relative;
        z-index: 10;
        text-align: center;
        display: flex;
        flex-direction: column;
        gap: 10px;
        font-size: clamp(26px, 8vw, 48px);
        font-weight: 700;
        color: pink;
        text-shadow: 0 0 20px #fff, 0 0 40px hotpink;
      }

      #message .line1,
      #message .line2 {
        opacity: 0;
        transition: opacity 0.8s;
      }

      #message .show {
        opacity: 1;
      }

      #emLove {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 11;
        font-weight: 600;
        color: hotpink;
        text-shadow: 0 0 28px rgba(255, 182, 193, 0.5);
        font-size: clamp(10px, 10vw, 100px);
        opacity: 0;
        transition: opacity 0.25s;
        white-space: nowrap;
      }

      #emLove.show {
        opacity: 1;
      }

      #particleCanvas {
        position: absolute;
        inset: 0;
        z-index: 12;
        display: none;
      }

      /* ===== M√†n 3 ===== */
      :root {
        --ring-size: min(58vw, 18svh);
        --img-size: calc(var(--ring-size) * 0.38);
        --tz: calc(var(--ring-size) * 0.85);
      }

      #fireworks {
        position: fixed;
        inset: 0;
        z-index: 0;
        pointer-events: none;
      }

      .stage {
        position: relative;
        z-index: 1;
        height: 100svh;
        display: grid;
        grid-template-rows: repeat(5, 20svh);
      }

      header {
        grid-row: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        font-weight: 800;
        font-size: clamp(22px, 6vw, 40px);
        background: linear-gradient(270deg, hotpink, #ffd54a, #fff, hotpink);
        background-size: 600% 600%;
        -webkit-background-clip: text;
        color: transparent;
        animation: colorShift 5s ease infinite;
      }

      @keyframes colorShift {
        0% {
          background-position: 0% 50%;
        }

        50% {
          background-position: 100% 50%;
        }

        100% {
          background-position: 0% 50%;
        }
      }

      .ring-cell {
        grid-row: 4;
        display: flex;
        align-items: center;
        justify-content: center;
        perspective: 1200px;
      }

      .ring {
        width: var(--ring-size);
        height: var(--ring-size);
        position: relative;
        transform-style: preserve-3d;
        animation: spin 18s linear infinite;
      }

      .ring.paused {
        animation-play-state: paused;
      }

      @keyframes spin {
        from {
          transform: rotateY(0);
        }

        to {
          transform: rotateY(360deg);
        }
      }

      .card {
        position: absolute;
        width: var(--img-size);
        height: var(--img-size);
        left: calc((var(--ring-size)-var(--img-size)) / 2);
        top: calc((var(--ring-size)-var(--img-size)) / 2);
        border-radius: 16px;
        overflow: hidden;
        backface-visibility: hidden;
        cursor: pointer;
        box-shadow: 0 0 15px rgba(255, 105, 180, 0.9),
          0 0 25px rgba(255, 255, 255, 0.6);
      }

      .card img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
      }

      .overlay {
        position: fixed;
        inset: 0;
        z-index: 10;
        display: none;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        background: rgba(0, 0, 0, 0.88);
        padding: 16px;
      }

      .overlay.active {
        display: flex;
      }

      .overlay__img {
        max-width: 94vw;
        max-height: 90svh;
        border-radius: 16px;
        box-shadow: 0 0 34px rgba(255, 255, 255, 0.85);
      }

      .overlay__cap {
        margin-top: 10px;
        font-size: clamp(14px, 3.6vw, 18px);
      }
    </style>
  </head>

  <body>
    <!-- Nh·∫°c -->
    <audio id="bgm" loop>
      <source src="audio/HPBD.mp3" type="audio/mpeg" />
    </audio>
    <div id="musicToggle">üéµ Click Nh·∫°c</div>

    <!-- M√†n 1 -->
    <div class="screen active" id="screen1">
      <div class="stars"></div>
      <div id="fallingWrap"></div>
      <div class="s1-container">
        <img src="images/1.gif" class="medal" width="240" alt="medal" />
        <input id="birthday" type="text" placeholder="‚ù§ 2508 ‚ù§" inputmode="numeric"/>
        <button id="confirmBtn">üå∏ Ng√†y ƒë·∫∑c bi·ªát c·ªßa em ‚ú®</button>
      </div>
    </div>

    <!-- M√†n 2 -->
    <div class="screen" id="screen2">
      <canvas id="matrix"></canvas>
      <canvas id="particleCanvas"></canvas>
      <div id="countdown"></div>
      <div id="message">
        <div class="line1"></div>
        <div class="line2"></div>
        <div id="emLove">üíñHaa Anhüíñ</div>
      </div>
    </div>

    <!-- M√†n 3 -->
    <div class="screen" id="screen3">
      <canvas id="fireworks"></canvas>
      <div class="stage">
        <header>üéâ HAPPY BIRTHDAY üéâ</header>
        <div class="ring-cell">
          <div class="ring" id="ring">
            <div class="card" data-cap="Lu√¥n vui v·∫ª, h·∫°nh ph√∫c ‚ù§Ô∏è">
              <img src="images/ha1.jpg" />
            </div>
            <div class="card" data-cap="Th√†nh c√¥ng v√† may m·∫Øn üçÄ">
              <img src="images/ha2.jpg" />
            </div>
            <div class="card" data-cap="S·ª©c kh·ªèe d·ªìi d√†o üí™">
              <img src="images/ha3.jpg" />
            </div>
            <div class="card" data-cap="∆Ø·ªõc m∆° s·ªõm th√†nh hi·ªán th·ª±c ‚ú®">
              <img src="images/ha4.jpg" />
            </div>
            <div class="card" data-cap="Y√™u th∆∞∆°ng ng·∫≠p tr√†n üíñ">
              <img src="images/ha5.jpg" />
            </div>
            <div class="card" data-cap="H·∫°nh ph√∫c tr√†n ƒë·∫ßy üéâ">
              <img src="images/ha6.jpg" />
            </div>
            <div class="card" data-cap="ƒêi xe an to√†n !üöó">
              <img src="images/ha7.jpg" />
            </div>
          </div>
        </div>
      </div>
      <div class="overlay" id="overlay">
        <img class="overlay__img" id="overlayImg" alt="" />
        <div class="overlay__cap" id="overlayCap"></div>
      </div>
    </div>

    <script>
      /* ===== Nh·∫°c ===== */
      const bgm = document.getElementById("bgm");
      const musicToggle = document.getElementById("musicToggle");
      let isPlaying = false;
      musicToggle.addEventListener("click", () => {
        if (isPlaying) {
          bgm.pause();
          musicToggle.classList.remove("active");
          isPlaying = false;
        } else {
          bgm.play().catch(() => {});
          musicToggle.classList.add("active");
          isPlaying = true;
        }
      });

      /* ===== M√†n 1 ===== */
      function createFallingIcon() {
        const wrap = document.getElementById("fallingWrap");
        const icons = ["üéÇ", "‚ù§Ô∏è", "üçÄ", "üéâ"];
        const el = document.createElement("div");
        el.className = "falling";
        el.textContent = icons[(Math.random() * icons.length) | 0];
        el.style.left = Math.random() * 100 + "vw";
        el.style.animationDuration = 3 + Math.random() * 5 + "s";
        wrap.appendChild(el);
        setTimeout(() => el.remove(), 8000);
      }
      let fallingInterval = setInterval(createFallingIcon, 700);
      document.getElementById("confirmBtn").addEventListener("click", () => {
        if (document.getElementById("birthday").value.trim() === "2508") {
          clearInterval(fallingInterval);
          document.getElementById("screen1").classList.remove("active");
          document.getElementById("screen2").classList.add("active");
          startScreen2();
          bgm.play().catch(() => {});
          musicToggle.classList.add("active");
          isPlaying = true;
        } else alert("B·∫°n kh√¥ng nh·ªõ g√¨ h·∫øt !");
      });

      /* ===== Matrix HAPPY BIRTHDAY (m√†n 2) ===== */
      const matrixCanvas = document.getElementById("matrix");
      const matrixCtx = matrixCanvas.getContext("2d");
      let matrixCols = [];
      let matrixFontSize = 14;
      function resizeMatrix() {
        matrixCanvas.width = innerWidth;
        matrixCanvas.height = innerHeight;
        matrixFontSize = Math.max(12, Math.round(innerWidth / 80));
        const cols = Math.floor(matrixCanvas.width / matrixFontSize);
        matrixCols = new Array(cols).fill(1);
      }
      function drawMatrix() {
        matrixCtx.fillStyle = "rgba(0,0,0,0.08)";
        matrixCtx.fillRect(0, 0, matrixCanvas.width, matrixCanvas.height);
        matrixCtx.font = `${matrixFontSize}px monospace`;
        const letters = "HAPPY BIRTHDAY";
        for (let i = 0; i < matrixCols.length; i++) {
          const ch = letters.charAt(Math.floor(Math.random() * letters.length));
          matrixCtx.fillStyle = Math.random() > 0.5 ? "#fff" : "hotpink";
          matrixCtx.fillText(
            ch,
            i * matrixFontSize,
            matrixCols[i] * matrixFontSize
          );
          if (
            matrixCols[i] * matrixFontSize > matrixCanvas.height &&
            Math.random() > 0.975
          )
            matrixCols[i] = 0;
          matrixCols[i]++;
        }
      }

      /* ===== Countdown + HAA ANH ===== */
      function startScreen2() {
        let n = 3;
        const c = document.getElementById("countdown");
        const line1 = document.querySelector(".line1");
        const line2 = document.querySelector(".line2");
        const emLove = document.getElementById("emLove");
        resizeMatrix();
        let matrixInterval = setInterval(drawMatrix, 70); // ch·∫°y ch·∫≠m h∆°n
        (function run() {
          if (n > 0) {
            c.textContent = n;
            c.style.opacity = "1";
            setTimeout(() => {
              c.style.opacity = "0";
              n--;
              setTimeout(run, 1000);
            }, 800);
          } else {
            c.style.display = "none";
            line1.textContent = "CH√öC M·ª™NG";
            line1.classList.add("show");
            setTimeout(() => {
              line2.textContent = "SINH NH·∫¨T";
              line2.classList.add("show");
            }, 1200);
            setTimeout(() => {
              line1.classList.remove("show");
              line2.classList.remove("show");
              emLove.classList.add("show");
              setTimeout(() => {
                heartParticle(() => {
                  clearInterval(matrixInterval);
                  document.getElementById("screen2").classList.add("fade-out");
                  setTimeout(() => {
                    document
                      .getElementById("screen2")
                      .classList.remove("active", "fade-out");
                    document.getElementById("screen3").classList.add("active");
                    startScreen3();
                  }, 900);
                });
              }, 2000);
            }, 3400);
          }
        })();
      }

      /* ===== Particle tim ===== */
      function heartParticle(done) {
        const pcv = document.getElementById("particleCanvas");
        const ctx = pcv.getContext("2d");
        pcv.style.display = "block";
        pcv.width = innerWidth;
        pcv.height = innerHeight;
        const hearts = [];
        for (let i = 0; i < 120; i++) {
          hearts.push({
            x: innerWidth / 2,
            y: innerHeight / 2,
            vx: (Math.random() - 0.5) * 6,
            vy: (Math.random() - 1) * 5,
            life: 1,
          });
        }
        function drawHeart(x, y, s) {
          ctx.save();
          ctx.translate(x, y);
          ctx.scale(s, s);
          ctx.beginPath();
          ctx.moveTo(0, -2);
          ctx.bezierCurveTo(2, -4, 4, -2, 0, 2);
          ctx.bezierCurveTo(-4, -2, -2, -4, 0, -2);
          ctx.fillStyle = "rgba(255,105,180,0.8)";
          ctx.fill();
          ctx.restore();
        }
        function tick() {
          ctx.fillStyle = "rgba(0,0,0,0.2)";
          ctx.fillRect(0, 0, pcv.width, pcv.height);
          hearts.forEach((h) => {
            h.x += h.vx;
            h.y += h.vy;
            h.vy += 0.05;
            h.life -= 0.01;
            drawHeart(h.x, h.y, Math.max(h.life * 0.5, 0.1));
          });
          if (hearts.some((h) => h.life > 0)) requestAnimationFrame(tick);
          else {
            pcv.style.display = "none";
            done();
          }
        }
        tick();
      }

      /* ===== Fireworks (m√†n 3) ===== */
      function startScreen3() {
        const fw = document.getElementById("fireworks");
        const ctx = fw.getContext("2d");
        fw.width = innerWidth;
        fw.height = innerHeight;
        const particles = [];
        function Firework() {
          this.x = Math.random() * fw.width;
          this.y = fw.height;
          this.targetY = (Math.random() * fw.height) / 2;
          this.vy = -Math.random() * 3 - 4;
          this.color = `hsl(${Math.random() * 360},100%,70%)`;
          this.exploded = false;
        }
        Firework.prototype.update = function () {
          if (!this.exploded) {
            this.y += this.vy;
            if (this.y <= this.targetY) {
              this.exploded = true;
              for (let i = 0; i < 50; i++) {
                particles.push({
                  x: this.x,
                  y: this.y,
                  vx: (Math.random() - 0.5) * 6,
                  vy: (Math.random() - 0.5) * 6,
                  life: 100,
                  color: this.color,
                });
              }
            }
          }
        };
        function animate() {
          ctx.fillStyle = "rgba(0,0,0,0.2)";
          ctx.fillRect(0, 0, fw.width, fw.height);
          if (Math.random() < 0.05) particles.push(new Firework());
          for (let i = particles.length - 1; i >= 0; i--) {
            let p = particles[i];
            if (p.update) {
              p.update();
              if (!p.exploded)
                (ctx.fillStyle = p.color), ctx.fillRect(p.x, p.y, 2, 2);
            } else {
              p.x += p.vx;
              p.y += p.vy;
              p.vy += 0.05;
              p.life--;
              ctx.fillStyle = p.color;
              ctx.fillRect(p.x, p.y, 2, 2);
              if (p.life <= 0) particles.splice(i, 1);
            }
          }
          requestAnimationFrame(animate);
        }
        animate();

        /* setup ring */
        const ring = document.getElementById("ring");
        const cards = Array.from(ring.querySelectorAll(".card"));
        const step = 360 / cards.length;
        cards.forEach(
          (c, i) =>
            (c.style.transform = `rotateY(${
              i * step
            }deg) translateZ(var(--tz))`)
        );
        const overlay = document.getElementById("overlay"),
          ovImg = document.getElementById("overlayImg"),
          ovCap = document.getElementById("overlayCap");
        cards.forEach((card) => {
          card.addEventListener("click", () => {
            ovImg.src = card.querySelector("img").src;
            ovCap.textContent = card.dataset.cap || "";
            overlay.classList.add("active");
            ring.classList.add("paused");
          });
        });
        overlay.addEventListener("click", () => {
          overlay.classList.remove("active");
          ring.classList.remove("paused");
        });
      }

      // ===== Random text cute cho n√∫t m√†n 1 =====
      const btnTexts = [
        "üå∏ Haa Anh d·ªÖ th∆∞∆°ng ‚ú®",
        "üéÇ Haa Anh xinh ƒë·∫πp üíï",
        "üíñ Haa Anh cute ü•∞",
        "üåà Haa Anh ∆°i ‚ú®",
        "üç¨ Click ƒëi Haa Anh ng·ªçt ng√†o üç≠",
        "üéÅ Happy B-Day Haa Anh iu üíù",
      ];

      const confirmBtn = document.getElementById("confirmBtn");
      confirmBtn.textContent =
        btnTexts[Math.floor(Math.random() * btnTexts.length)];
    </script>
  </body>
</html>
